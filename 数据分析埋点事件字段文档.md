# 数据分析埋点事件字段文档

## 概述

本文档包含了应用中所有数据分析埋点事件的详细字段说明。所有事件都包含以下基础字段：

### 基础字段（所有事件共有）

| 字段名 | 类型 | 说明 |
|-------|------|------|
| event_name | string | 事件名称 |
| page_name | string \| null | 当前页面名称 |
| referrer_page | string \| null | 来源页面名称 |
| event_properties | array | 事件属性数组，包含事件的具体信息 |
| user_id | number \| null | 用户ID（从用户状态获取） |
| device_id | string | 设备标识（操作系统类型） |
| version | string | 版本标识（唯一生成） |
| session_id | string | 会话ID（唯一生成） |

## 事件列表

### 1. 应用启动事件 (app_launch)

**事件名称**: `app_launch`  
**页面名称**: `null`  
**来源页面**: `null`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| is_open | number | 是否成功启动（1=成功，0=失败） | 1 |
| timestamp | string | 时间戳（YYYY-MM-DD HH:MM:SS） | "2024-01-01 12:00:00" |

### 2. 登录事件 (login)

**事件名称**: `login`  
**页面名称**: `login`  
**来源页面**: `null`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| is_login | number | 是否登录成功（1=成功，0=失败） | 1 |
| login_method | string | 登录方式 | "phone", "email", "whatsapp" |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 3. 注册事件 (register)

**事件名称**: `register`  
**页面名称**: `register`  
**来源页面**: `null`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| is_register | number | 是否注册成功（1=成功，0=失败） | 1 |
| register_method | string | 注册方式 | "phone", "email" |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 4. 浏览商品事件 (product_view)

**事件名称**: `product_view`  
**页面名称**: `product_view`  
**来源页面**: 可变（默认"home"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| offer_id | number | 商品ID | 12345 |
| category_id | number | 分类ID | 10 |
| price | number | 商品价格 | 99.99 |
| sku_id | number | SKU ID | 54321 |
| currency | string | 货币类型 | "USD" |
| product_name | string | 商品名称 | "iPhone 15" |
| product_img | string | 商品图片URL | "https://..." |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 5. 搜索事件 (search)

**事件名称**: `search`  
**页面名称**: `search`  
**来源页面**: `home`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| key_word | string | 搜索关键词 | "手机" |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 6. 地址信息事件 (address)

**事件名称**: `address`  
**页面名称**: `address`  
**来源页面**: 可变（默认"cart"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| last_name | string | 姓氏 | "张" |
| first_name | string | 名字 | "三" |
| country | string | 国家 | "中国" |
| phone_number | number | 电话号码 | 13800138000 |
| whatsApp_number | number | WhatsApp号码 | 13800138000 |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 7. 物流确认事件 (shipping)

**事件名称**: `shipping`  
**页面名称**: `shipping`  
**来源页面**: 可变（默认"address"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| shipping_method | number | 物流方式 | 1 |
| shipping_price_outside | number | 境外运费 | 50.00 |
| shipping_price_within | number | 境内运费 | 10.00 |
| currency | string | 货币类型 | "USD" |
| forwarder_name | string | 物流公司名称 | "顺丰快递" |
| country_city | string | 国家城市 | "中国-深圳" |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 8. 支付方式确认事件 (payment)

**事件名称**: `payment`  
**页面名称**: `payment`  
**来源页面**: 可变（默认"shipping"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| pay_method | string | 支付方式 | "credit_card" |
| offline_payment | number | 是否线下支付 | 0 |
| all_price | number | 总价格 | 999.99 |
| currency | string | 货币类型 | "USD" |
| pay_product | string | 支付产品（可选） | "stripe" |
| shipping_method | number | 物流方式 | 1 |
| shipping_price_outside | number | 境外运费 | 50.00 |
| shipping_price_within | number | 境内运费 | 10.00 |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 9. 预览订单事件 (order)

**事件名称**: `order`  
**页面名称**: `order`  
**来源页面**: 可变（默认"pay_method"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 10. 结账事件 (checkout)

**事件名称**: `checkout`  
**页面名称**: `checkout`  
**来源页面**: 可变（默认"perview"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| is_suc | number | 是否成功（1=成功，0=失败） | 1 |
| all_price | number | 总价格 | 999.99 |
| currency | string | 货币类型 | "USD" |
| shipping_method | number | 物流方式 | 1 |
| shipping_price_outside | number | 境外运费 | 50.00 |
| shipping_price_within | number | 境内运费 | 10.00 |
| pay_product | string | 支付产品（可选） | "stripe" |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 11. 添加购物车事件 (addToCart)

**事件名称**: `addToCart`  
**页面名称**: `addToCart`  
**来源页面**: `search`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| offer_id | number | 商品ID | 12345 |
| category_id | number | 分类ID | 10 |
| price | number | 单价 | 99.99 |
| all_price | number | 总价格 | 199.98 |
| currency | string | 货币类型 | "USD" |
| sku_id | number | SKU ID | 54321 |
| quantity | number | 数量 | 2 |
| product_name | string | 商品名称 | "iPhone 15" |
| sku_img | string | SKU图片URL | "https://..." |
| all_quantity | number | 总数量 | 5 |
| level | number | 级别（可选） | 1 |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 12. 分类事件 (category)

**事件名称**: `category`  
**页面名称**: `category`  
**来源页面**: 可变（主分类默认"home"，子分类默认"category"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| category_id | number | 分类ID | 10 |
| category_name | string | 分类名称 | "电子产品" |
| category_type | string | 分类类型 | "main_category" 或 "sub_category" |
| level | number | 级别（可选） | 1 |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 13. 子分类事件 (sub_category)

**事件名称**: `sub_category`  
**页面名称**: `sub_category`  
**来源页面**: 可变（默认"category"）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| category_id | number | 分类ID | 101 |
| category_name | string | 分类名称 | "手机" |
| level | number | 级别（可选） | 2 |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 14. 页面浏览事件 (page_view)

**事件名称**: `page_view`  
**页面名称**: 可变（实际页面名称）  
**来源页面**: 可变（来源页面）

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 15. 页面离开事件 (page_leave)

**事件名称**: `page_leave`  
**页面名称**: 可变（实际页面名称）  
**来源页面**: `null`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| duration | number | 页面停留时长（秒） | 30 |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 16. 错误事件 (error)

**事件名称**: `error`  
**页面名称**: 可变（上下文）  
**来源页面**: `null`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| error_message | string | 错误信息 | "Network request failed" |
| error_stack | string | 错误堆栈（可选） | "Error: Network..." |
| context | string | 错误上下文 | "product_detail" |
| user_agent | string | 用户代理（操作系统） | "ios" |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

### 17. 会话结束事件 (session_end)

**事件名称**: `session_end`  
**页面名称**: `null`  
**来源页面**: `null`

**事件属性**:
| 字段名 | 类型 | 说明 | 示例值 |
|-------|------|------|--------|
| session_duration | number | 会话时长（秒） | 3600 |
| page_count | number | 访问页面数 | 15 |
| event_count | number | 事件总数 | 50 |
| timestamp | string | 时间戳 | "2024-01-01 12:00:00" |

## 数据发送规则

1. **批量发送**: 当事件数量达到10个时，立即触发发送
2. **定时发送**: 30秒定时器，如果有待发送事件则发送
3. **会话结束**: 应用进入后台时记录会话结束并立即发送
4. **网络恢复**: 网络恢复时自动发送缓存的事件
5. **本地缓存**: 发送失败的事件会缓存到本地，最多缓存1000个事件
6. **重试机制**: 发送失败后会进行3次重试，延迟分别为1秒、5秒、15秒

## 时间格式

所有时间戳字段统一使用格式：`YYYY-MM-DD HH:MM:SS`

示例：`2024-01-01 12:00:00`

## 注意事项

1. 所有价格字段都是数值类型，配合currency字段使用
2. 所有成功/失败标识使用数字：1=成功，0=失败
3. 页面名称和来源页面用于追踪用户路径
4. 每个事件的event_properties是一个数组，但通常只包含一个对象